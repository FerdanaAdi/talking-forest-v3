<!DOCTYPE html>
<html lang="id">

<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                                              ‚ïë
‚ïë   üìÑ NAMA FILE: v3/garden.html                                               ‚ïë
‚ïë   üå± FUNGSI: Halaman "Kebun Saya" (Koleksi & Side Quest)                     ‚ïë
‚ïë   üìç POSISI: Diakses dari Dashboard/Progress Player                          ‚ïë
‚ïë                                                                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üî∞ PANDUAN UNTUK NAJU
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Halo Naju! üëã

Halaman ini adalah "Markas" pemain. Di sini mereka bisa:
1. Melihat semua spesies yang sudah ditemukan (Pohon/Tanaman/Hewan).
2. Menyiram kebun (Side Mission harian) untuk dapat XP.
3. Melihat kesehatan kebun mereka.

Update: Layout sudah disesuaikan agar terlihat seperti Mobile App di Desktop.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üìö SIMBOL-SIMBOL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üü¢ = BOLEH EDIT (Teks, Warna, Ukuran)
üî¥ = JANGAN EDIT (Logic Alpine.js, Struktur Grid)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talking Forest V3 - Kebun Saya</title>

    <!-- üî¥ LIBRARIES - JANGAN EDIT -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- üü¢ LOGIC SCRIPTS (Load before Alpine) -->
    <script defer src="../js/v3/components/system-ui.js"></script>
    <script defer src="../js/v3/pages/garden.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <!-- üü¢ FONTS & ICONS -->
    <link href="https://fonts.googleapis.com/css2?family=Bakso+Sapi&family=Nunito:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

    <!-- üî¥ CSS - JANGAN EDIT -->
    <link rel="stylesheet" href="../css/game.css">
    <link rel="stylesheet" href="../css/system-ui.css">

    <!-- System UI Store (Inline) -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.store('systemUI', {
                toasts: [],
                toastIdCounter: 0,
                showToast(message, type = 'info', duration = 3000) {
                    const id = ++this.toastIdCounter;
                    const toast = { id, message, type, visible: true };
                    this.toasts.push(toast);
                    setTimeout(() => {
                        this.hideToast(id);
                    }, duration);
                },
                hideToast(id) {
                    const index = this.toasts.findIndex(t => t.id === id);
                    if (index !== -1) {
                        this.toasts[index].visible = false;
                        setTimeout(() => {
                            this.toasts = this.toasts.filter(t => t.id !== id);
                        }, 300);
                    }
                },
                modal: {
                    isOpen: false,
                    type: null,
                    data: {}
                },
                showModal(type, data = {}) {
                    console.log('üîî [SystemUI] Opening Modal:', type, data);
                    this.modal = {
                        isOpen: true,
                        type: type,
                        data: data
                    };
                },
                closeModal() {
                    this.modal.isOpen = false;
                    this.modal.type = null;
                    this.modal.data = {};
                },
                loading: {
                    isActive: false,
                    message: 'Memuat...'
                },
                setLoading(isActive, message = 'Memuat...') {
                    this.loading.isActive = isActive;
                    this.loading.message = message;
                },
                error: {
                    isActive: false,
                    code: null,
                    message: ''
                },
                showError(code, message) {
                    this.error = {
                        isActive: true,
                        code: code,
                        message: message
                    };
                },
                hideError() {
                    this.error.isActive = false;
                    this.error.code = null;
                    this.error.message = '';
                },
                settings: {
                    sfxVolume: parseFloat(localStorage.getItem('tfv3_sfx_volume') || '0.5'),
                    bgmVolume: parseFloat(localStorage.getItem('tfv3_bgm_volume') || '0.3'),
                    language: localStorage.getItem('tfv3_language') || 'id',
                    darkMode: localStorage.getItem('tfv3_dark_mode') === 'true',
                    animationsEnabled: localStorage.getItem('tfv3_animations') !== 'false'
                },
                saveSetting(key, value) {
                    this.settings[key] = value;
                    localStorage.setItem('tfv3_' + key.replace(/([A-Z])/g, '_$1').toLowerCase(), value);
                }
            });
        });
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        forest: { DEFAULT: '#2E7D32', dark: '#1B5E20', light: '#4CAF50' },
                        earth: { DEFAULT: '#5D4037', dark: '#3E2723', light: '#8D6E63' },
                        wood: '#8D6E63',
                        sky: '#E1F5FE',
                    },
                    fontFamily: {
                        bakso: ['Bakso Sapi', 'cursive'],
                        nunito: ['Nunito', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* üü¢ Custom Style untuk Health Bar */
        .health-pattern {
            background-image: linear-gradient(45deg, rgba(255, 255, 255, .15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .15) 50%, rgba(255, 255, 255, .15) 75%, transparent 75%, transparent);
            background-size: 1rem 1rem;
        }

        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }
    </style>
</head>

<!-- üî¥ BODY: LAYOUT SENTRALISASI MOBILE -->

<body class="bg-zinc-900 h-screen w-screen flex items-center justify-center overflow-hidden font-nunito"
    x-data="gardenPage()" x-init="init()">

    <!-- üü¢ MOBILE FRAME CONTAINER (Max Width 480px) -->
    <div class="w-full max-w-[480px] h-full relative shadow-2xl overflow-hidden bg-repeat flex flex-col"
        style="background-image: url('../assets/images/ui/pattern-leaf.png'); background-color: #F1F8E9;">

        <!-- üü¢ HEADER SECTION (Absolute) -->
        <header
            class="absolute top-0 w-full z-50 bg-forest/95 backdrop-blur shadow-lg border-b-4 border-earth text-white p-4 rounded-b-[2rem]">
            <div class="flex items-center justify-between">
                <!-- Tombol Kembali -->
                <button onclick="window.location.href='../index.html'"
                    class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center hover:bg-white/30 transition active:scale-90">
                    <span class="material-icons-round">arrow_back</span>
                </button>

                <!-- Judul -->
                <h1 class="text-2xl font-bakso tracking-wide drop-shadow-md">üå± KEBUN SAYA</h1>

                <!-- Placeholder Kanan -->
                <div class="w-10"></div>
            </div>

            <!-- üî¥ HEALTH BAR SECTION -->
            <div class="mt-4 px-2">
                <div class="flex justify-between text-sm font-bold mb-1 px-1">
                    <span>‚ù§Ô∏è Kesehatan Kebun</span>
                    <span x-text="gardenHealth + '%'">100%</span>
                </div>

                <div class="w-full h-6 bg-black/30 rounded-full border-2 border-white/30 relative overflow-hidden">
                    <!-- Bar Fill -->
                    <div class="h-full transition-all duration-1000 ease-out health-pattern flex items-center justify-center text-[10px]"
                        :class="{
                        'bg-red-500': gardenHealth < 30,
                        'bg-yellow-500': gardenHealth >= 30 && gardenHealth < 70,
                        'bg-green-500': gardenHealth >= 70
                     }" :style="`width: ${gardenHealth}%`">
                    </div>
                </div>

                <!-- üü¢ TOMBOL SIRAM -->
                <!-- Muncul kalau health < 100 -->
                <div x-show="gardenHealth < 100" x-transition.scale class="mt-3 flex justify-center">
                    <button @click="waterGarden()"
                        class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full shadow-lg border-b-4 border-blue-700 active:border-b-0 active:translate-y-1 transition-all flex items-center gap-2 animate-bounce">
                        <span class="material-icons-round">water_drop</span>
                        SIRAM (+10 XP)
                    </button>
                </div>

                <!-- Pesan kalau sudah penuh -->
                <div x-show="gardenHealth >= 100" class="mt-2 text-center text-xs text-green-100 font-bold opacity-80">
                    ‚ú® Kebunmu sangat subur hari ini! ‚ú®
                </div>
            </div>
        </header>

        <!-- üü¢ MAIN SCROLLABLE CONTENT -->
        <!-- pt-[240px] agar konten tidak tertutup header -->
        <main class="flex-1 w-full overflow-y-auto pb-24 pt-[240px] px-4 no-scrollbar">

            <!-- üî¥ FILTER TABS (Sticky) -->
            <div class="flex bg-white rounded-xl shadow-md p-1 mb-6 border-2 border-forest/20 sticky top-0 z-40">

                <button @click="setFilter('pohon')"
                    class="flex-1 py-2 rounded-lg font-bold text-sm transition-all flex flex-col items-center gap-1"
                    :class="activeFilter === 'pohon' ? 'bg-forest text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'">
                    <span class="text-lg">üå≥</span>
                    <span>Pohon</span>
                </button>

                <button @click="setFilter('tanaman')"
                    class="flex-1 py-2 rounded-lg font-bold text-sm transition-all flex flex-col items-center gap-1"
                    :class="activeFilter === 'tanaman' ? 'bg-forest text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'">
                    <span class="text-lg">üå∏</span>
                    <span>Tanaman</span>
                </button>

                <button @click="setFilter('hewan')"
                    class="flex-1 py-2 rounded-lg font-bold text-sm transition-all flex flex-col items-center gap-1"
                    :class="activeFilter === 'hewan' ? 'bg-forest text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'">
                    <span class="text-lg">ü¶Å</span>
                    <span>Hewan</span>
                </button>

                <!-- Tombol ALL -->
                <button @click="setFilter('all')"
                    class="w-[15%] py-2 rounded-lg font-bold text-sm transition-all flex flex-col items-center gap-1 border-l border-gray-100"
                    :class="activeFilter === 'all' ? 'bg-earth text-white shadow-md' : 'text-gray-400 hover:bg-gray-50'">
                    <span class="text-lg">üëÅÔ∏è</span>
                </button>
            </div>

            <!-- üî¥ GRID KOLEKSI -->
            <div x-show="isLoading" class="text-center py-10">
                <div class="animate-spin text-4xl mb-2">‚è≥</div>
                <p class="text-gray-500 font-bold">Memuat Kebun...</p>
            </div>

            <div x-show="!isLoading" class="grid grid-cols-3 gap-3" style="display: none;"
                :style="!isLoading && { display: 'grid' }"> <!-- Prevent flash -->

                <template x-for="item in filteredSpecies" :key="item.id">

                    <!-- üü¢ ITEM CARD -->
                    <div @click="openDetail(item)"
                        class="aspect-[4/5] rounded-xl relative overflow-hidden shadow-sm hover:shadow-lg transition-all transform hover:-translate-y-1 cursor-pointer border-2"
                        :class="isUnlocked(item.id) ? 'bg-white border-white' : 'bg-gray-200 border-gray-300 opacity-80'">

                        <!-- Gambar -->
                        <div class="w-full h-full flex flex-col items-center justify-center p-2">
                            <template x-if="isUnlocked(item.id)">
                                <!-- Unlocked State -->
                                <div class="text-center w-full h-full flex flex-col">
                                    <img :src="'../assets/images/species/' + (item.assets?.siluet || item.assets?.full || item.image || 'placeholder.png')"
                                        class="w-full h-[70%] object-contain drop-shadow-sm"
                                        onerror="this.src='../assets/images/ui/placeholder-leaf.png'"> <!-- Fallback -->
                                    <div class="h-[30%] flex items-center justify-center">
                                        <span
                                            class="text-[10px] font-bold leading-tight text-forest text-center line-clamp-2"
                                            x-text="item.name || '???'"></span>
                                    </div>
                                </div>
                            </template>

                            <template x-if="!isUnlocked(item.id)">
                                <!-- Locked State -->
                                <div class="text-center">
                                    <div class="text-3xl grayscale opacity-30 mb-1">üîí</div>
                                    <span class="text-[10px] font-bold text-gray-400">???</span>
                                </div>
                            </template>
                        </div>

                        <!-- Badge Type (Icon Kecil di pojok) -->
                        <div class="absolute top-1 right-1 text-[10px] w-5 h-5 rounded-full flex items-center justify-center border border-white/50 shadow-sm"
                            :class="{
                            'bg-green-100 text-green-700': item.type === 'pohon',
                            'bg-pink-100 text-pink-700': item.type === 'tanaman',
                            'bg-orange-100 text-orange-700': item.type === 'hewan'
                         }">
                            <span
                                x-text="item.type === 'pohon' ? 'üå≥' : (item.type === 'tanaman' ? 'üå∏' : 'ü¶Å')"></span>
                        </div>

                    </div>
                </template>
            </div>

            <!-- üî¥ EMPTY STATE -->
            <div x-show="!isLoading && filteredSpecies.length === 0" class="text-center py-10 opacity-60">
                <div class="text-4xl mb-2">üçÉ</div>
                <p>Belum ada koleksi di kategori ini.</p>
            </div>

        </main>

        <!-- üü¢ STATS SECTION (Moved from Footer) -->
        <!-- Placed absolute bottom of main/above nav or just flow with content? 
             Master plan places it at the bottom of the grid view. 
             If we want it valid, put it as the last item in main. -->

        <!-- üî¥ STATS SUMMARY -->
        <div class="mt-6 mb-4 bg-white/80 backdrop-blur rounded-xl p-4 border border-forest/10 shadow-sm">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-bold text-gray-600 uppercase tracking-wider">Total Koleksi</span>
                <span class="text-lg font-bakso text-forest"
                    x-text="inventory.length + ' / ' + allSpecies.length"></span>
            </div>
            <!-- Progress Bar Simple -->
            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                <div class="bg-forest h-full rounded-full transition-all duration-1000 relative"
                    :style="'width: ' + (allSpecies.length > 0 ? (inventory.length / allSpecies.length * 100) : 0) + '%'">
                    <!-- Shimmer effect -->
                    <div class="absolute inset-0 bg-white/30 w-full h-full animate-[shimmer_2s_infinite]"></div>
                </div>
            </div>
            <div class="text-right text-[10px] font-bold text-gray-400 mt-1">
                <span
                    x-text="allSpecies.length > 0 ? Math.round(inventory.length / allSpecies.length * 100) + '%' : '0%'"></span>
                Selesai
            </div>
        </div>

        </main>

        <!-- üü¢ PROGRESS FOOTER (Absolute Bottom) -->
        <!-- üü¢ BOTTOM NAVIGATION BAR -->
        <nav
            class="absolute bottom-0 w-full z-50 bg-forest/95 backdrop-blur text-white rounded-t-3xl border-t-4 border-earth shadow-[0_-10px_20px_rgba(0,0,0,0.3)] pb-4 pt-2">
            <div class="flex justify-around items-end h-full px-2 pb-2">

                <!-- 1. MARKAS (Home) -->
                <a href="../index.html"
                    class="flex flex-col items-center gap-1 w-1/5 opacity-70 hover:opacity-100 transition active:scale-95">
                    <span class="text-2xl filter drop-shadow-sm">üè†</span>
                    <span class="text-[9px] font-bold text-white/90">Markas</span>
                </a>

                <!-- 2. JELAJAH (Scan) -->
                <a href="../scan.html"
                    class="flex flex-col items-center gap-1 w-1/5 opacity-70 hover:opacity-100 transition active:scale-95">
                    <span class="text-2xl filter drop-shadow-sm">üì∏</span>
                    <span class="text-[9px] font-bold text-white/90">Jelajah</span>
                </a>

                <!-- 3. KEBUN (Active) -->
                <div class="flex flex-col items-center gap-1 w-1/5 opacity-100 scale-110 relative -top-3">
                    <div
                        class="bg-white/10 p-2 rounded-full border-2 border-yellow-300 shadow-[0_0_15px_rgba(253,224,71,0.5)] backdrop-blur-md">
                        <span class="text-2xl filter drop-shadow-md">üåø</span>
                    </div>
                    <span class="text-[9px] font-bold text-yellow-300">Kebun</span>
                </div>

                <!-- 4. DONASI -->
                <a href="donate.html"
                    class="flex flex-col items-center gap-1 w-1/5 opacity-70 hover:opacity-100 transition active:scale-95">
                    <span class="text-2xl filter drop-shadow-sm">üíö</span>
                    <span class="text-[9px] font-bold text-white/90">Donasi</span>
                </a>

                <!-- 5. PROFIL -->
                <a href="profile.html"
                    class="flex flex-col items-center gap-1 w-1/5 opacity-70 hover:opacity-100 transition active:scale-95">
                    <span class="text-2xl filter drop-shadow-sm">üë§</span>
                    <span class="text-[9px] font-bold text-white/90">Profil</span>
                </a>

            </div>
        </nav>

    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         SYSTEM UI TEMPLATES (ALUR 12-15)
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

    <!-- Toast Container -->
    <div class="toast-container" x-data x-show="$store.systemUI.toasts.length > 0">
        <template x-for="toast in $store.systemUI.toasts" :key="toast.id">
            <div class="toast" :class="[toast.type, !toast.visible ? 'hiding' : '']" x-show="toast.visible"
                x-transition>
                <span class="toast-icon"
                    x-text="toast.type === 'success' ? '‚úÖ' : toast.type === 'error' ? '‚ùå' : toast.type === 'xp' ? '‚≠ê' : '‚ÑπÔ∏è'"></span>
                <span x-text="toast.message"></span>
            </div>
        </template>
    </div>

    <!-- Modal Overlay -->
    <div x-data>
        <template x-if="$store.systemUI.modal.isOpen">
            <div class="modal-overlay"
                :class="{'modal-level-up': $store.systemUI.modal.type === 'LEVEL_UP', 'modal-achievement': $store.systemUI.modal.type === 'ACHIEVEMENT_UNLOCK'}">

                <!-- Level Up Modal -->
                <template x-if="$store.systemUI.modal.type === 'LEVEL_UP'">
                    <div class="modal-content">
                        <div class="level-badge" x-text="$store.systemUI.modal.data.level || '?'"></div>
                        <h2 class="modal-title">üéâ SELAMAT! üéâ</h2>
                        <p class="modal-subtitle"
                            style="text-align:center; font-weight:bold; color:#4CAF50; margin-bottom:10px;">NAIK LEVEL!
                        </p>
                        <p class="modal-body">Kamu sekarang di Level <span
                                x-text="$store.systemUI.modal.data.level"></span>!</p>

                        <!-- Rank & Stars -->
                        <template x-if="$store.systemUI.modal.data.rank">
                            <div class="level-rank"
                                style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                <p style="margin-bottom: 4px;">Rank: <strong
                                        x-text="$store.systemUI.modal.data.rank"></strong></p>
                                <div class="star-rating" style="color: #FFD700; letter-spacing: 2px;"
                                    x-html="'‚òÖ'.repeat($store.systemUI.modal.data.stars || 0) + '‚òÜ'.repeat(5 - ($store.systemUI.modal.data.stars || 0))">
                                </div>
                            </div>
                        </template>

                        <!-- Bonus -->
                        <template x-if="$store.systemUI.modal.data.bonus">
                            <div class="level-bonus" style="margin-top: 10px; font-size: 0.9em;">
                                <p>üéÅ BONUS:</p>
                                <p style="color: #F59E0B; font-weight:bold;"
                                    x-text="'+' + ($store.systemUI.modal.data.bonus.xp || 0) + ' XP'"></p>
                                <template x-if="$store.systemUI.modal.data.bonus.unlock">
                                    <p style="color: #4CAF50;">üîì <span
                                            x-text="$store.systemUI.modal.data.bonus.unlock"></span></p>
                                </template>
                            </div>
                        </template>

                        <div class="modal-actions">
                            <button class="modal-btn primary" @click="$store.systemUI.closeModal()">LANJUT ‚ñ∂</button>
                        </div>
                    </div>
                </template>

                <!-- Achievement Unlock Modal (ALUR 12.4) -->
                <template x-if="$store.systemUI.modal.type === 'ACHIEVEMENT_UNLOCK'">
                    <div class="modal-content">
                        <div class="modal-icon badge-bounce">üîì</div>
                        <h2 class="modal-title">LENCANA BARU!</h2>
                        <div class="badge-icon-large" x-text="$store.systemUI.modal.data.badge?.icon || 'üèÜ'"></div>
                        <h3 class="badge-name" x-text="$store.systemUI.modal.data.badge?.name || 'Badge'"></h3>
                        <p class="modal-body" x-text="$store.systemUI.modal.data.badge?.description || ''"></p>
                        <p class="xp-reward" x-text="'+' + ($store.systemUI.modal.data.xp || 50) + ' XP üéâ'"></p>
                        <div class="modal-actions">
                            <button class="modal-btn primary" @click="$store.systemUI.closeModal()">KEREN! ‚úì</button>
                        </div>
                    </div>
                </template>

                <!-- Badge Detail Modal -->
                <template x-if="$store.systemUI.modal.type === 'BADGE_DETAIL'">
                    <div class="modal-content">
                        <div class="modal-icon" x-text="$store.systemUI.modal.data.icon || 'üèÜ'"></div>
                        <h2 class="modal-title" x-text="$store.systemUI.modal.data.name || 'Badge'"></h2>
                        <p class="modal-body" x-text="$store.systemUI.modal.data.description || ''"></p>
                        <template x-if="$store.systemUI.modal.data.date">
                            <p class="badge-date" style="font-size: 0.8em; color: #6B7280; margin-top: 5px;">
                                üìÖ Didapat: <span x-text="$store.systemUI.modal.data.date"></span></p>
                        </template>
                        <div class="modal-actions">
                            <button class="modal-btn primary" @click="$store.systemUI.closeModal()">Tutup</button>
                        </div>
                    </div>
                </template>

                <!-- Confirm Exit Modal -->
                <template x-if="$store.systemUI.modal.type === 'CONFIRM_EXIT'">
                    <div class="modal-content">
                        <div class="modal-icon">‚ö†Ô∏è</div>
                        <h2 class="modal-title">TUNGGU DULU!</h2>
                        <p class="modal-body"
                            x-text="$store.systemUI.modal.data.message || 'Kamu yakin mau keluar? Progress belum tersimpan!'">
                        </p>
                        <div class="modal-actions">
                            <button class="modal-btn secondary"
                                @click="$store.systemUI.modal.data.onConfirm?.(); $store.systemUI.closeModal()">KELUAR</button>
                            <button class="modal-btn primary" @click="$store.systemUI.closeModal()">LANJUT ‚ñ∂</button>
                        </div>
                    </div>
                </template>

                <!-- Edit Nickname Modal (ALUR 12.1) -->
                <template x-if="$store.systemUI.modal.type === 'EDIT_NICKNAME'" x-data="{ 
                newName: $store.systemUI.modal.data.currentName || '',
                limit: 15
            }">
                    <div class="modal-content relative pt-10 px-6 pb-6 text-left">
                        <button @click="$store.systemUI.closeModal()"
                            class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition">
                            <span class="material-icons-round">close</span>
                        </button>
                        <div class="text-center mb-6">
                            <h2 class="text-xl font-bold text-forest flex items-center justify-center gap-2">
                                <span>‚úèÔ∏è</span> EDIT NICKNAME
                            </h2>
                            <div class="h-1 w-32 bg-forest/20 mx-auto mt-2 rounded-full"></div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-xs font-bold text-gray-500 mb-1">Nama saat ini:</label>
                            <div class="text-lg font-bakso text-gray-800 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200"
                                x-text="'&quot;' + ($store.systemUI.modal.data.currentName || '-') + '&quot;'"></div>
                        </div>
                        <div class="mb-2">
                            <label class="block text-xs font-bold text-gray-500 mb-1">Nama baru:</label>
                            <input type="text" x-model="newName" :maxlength="limit" placeholder="Ketik nama baru..."
                                class="w-full px-4 py-3 rounded-xl bg-white border-2 border-forest/30 text-gray-800 font-bold focus:outline-none focus:border-forest transition placeholder-gray-400 shadow-inner">
                        </div>
                        <div class="flex justify-between text-xs font-bold text-gray-400 mb-4 px-1">
                            <span x-show="newName.length === 0" class="text-red-400">*Wajib diisi</span>
                            <span x-show="newName.length > 0"></span>
                            <span x-text="newName.length + '/' + limit + ' karakter'"></span>
                        </div>
                        <div class="flex items-center gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200 mb-6">
                            <span class="text-yellow-600">‚ö†Ô∏è</span>
                            <span class="text-xs text-yellow-700 font-bold">
                                Sisa ganti: <span x-text="$store.systemUI.modal.data.remainingEdits || 2">2</span>x
                            </span>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <button
                                class="modal-btn secondary !text-gray-500 hover:!bg-gray-100 flex items-center justify-center"
                                @click="$store.systemUI.closeModal()">
                                BATAL
                            </button>
                            <button
                                class="modal-btn primary flex items-center justify-center shadow-lg shadow-green-500/30"
                                @click="if(newName.trim().length > 0) { $store.systemUI.modal.data.onSave?.(newName); $store.systemUI.closeModal(); } else { alert('Nama tidak boleh kosong!'); }"
                                :disabled="newName.trim().length === 0"
                                :class="newName.trim().length === 0 ? 'opacity-50 cursor-not-allowed filter grayscale' : ''">
                                SIMPAN
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </template>
    </div><!-- end x-data wrapper for modal -->

    <!-- Toast Notifications -->
    <div class="toast-container" x-data>
        <template x-for="toast in $store.systemUI.toasts" :key="toast.id">
            <div class="toast" :class="{
                     'toast-success': toast.type === 'success',
                     'toast-error': toast.type === 'error',
                     'toast-xp': toast.type === 'xp',
                     'toast-info': toast.type === 'info',
                     'show': toast.visible
                 }" x-show="toast.visible" x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0"
                x-transition:leave="transition ease-in duration-300"
                x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 translate-y-2">

                <div class="toast-icon">
                    <span x-show="toast.type === 'success'">‚úÖ</span>
                    <span x-show="toast.type === 'error'">‚ùå</span>
                    <span x-show="toast.type === 'xp'">‚ú®</span>
                    <span x-show="toast.type === 'info'">‚ÑπÔ∏è</span>
                </div>
                <div class="toast-message" x-text="toast.message"></div>
            </div>
        </template>
    </div>

    <!-- Loading Overlay -->
    <template x-if="$store.systemUI.loading.isActive" x-data>
        <div class="loading-overlay">
            <div class="loading-spinner"></div>
            <p class="loading-text" x-text="$store.systemUI.loading.message"></p>
        </div>
    </template>

    <!-- Error Overlay -->
    <template x-if="$store.systemUI.error.isActive" x-data>
        <div class="error-overlay" :class="$store.systemUI.error.code === 'OFFLINE' ? 'error-offline' : ''">
            <div class="error-icon" x-text="$store.systemUI.error.code === 'OFFLINE' ? 'üì°' : 'üòµ'"></div>
            <h2 class="error-title"
                x-text="$store.systemUI.error.code === 'OFFLINE' ? 'Tidak Ada Koneksi' : 'Terjadi Kesalahan'"></h2>
            <p class="error-message" x-text="$store.systemUI.error.message"></p>

            <div class="error-actions" style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button class="error-btn" @click="$store.systemUI.hideError(); location.reload()">Coba Lagi üîÑ</button>

                <template x-if="$store.systemUI.error.code === 'OFFLINE'">
                    <button class="error-btn secondary"
                        style="background: transparent; border: 1px solid rgba(255,255,255,0.3);"
                        @click="$store.systemUI.hideError()">MODE OFFLINE üì¥</button>
                </template>

                <template x-if="$store.systemUI.error.code !== 'OFFLINE'">
                    <button class="error-btn secondary"
                        style="background: transparent; border: 1px solid rgba(255,255,255,0.3);"
                        @click="window.location.href='index.html'">KEMBALI KE HOME</button>
                </template>
            </div>
        </div>
    </template>




</body>

</html>